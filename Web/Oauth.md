# OAuth

- Open Authentication의 약자.
- 외부 서비스에서도 인증을 가능하게 하고 그 서비스의 API를 이용하게 해줄 수 있도록 인증하고 어플리케이션에 접근 권한을 부여하는 개방형 표준 방법
  (즉, 외부 서비스에서도 A 서비스의 일부 기능을 사용할 수 있게 된다.
이때 외부 서비스에서 A에 로그인을 해야 하는 것이 아니라 별도의 인증 절차를 거치면 외부 서비스에서 A의 기능을 이용할 수 있는 것.)
- OAuth를 이용하여 사용자를 인증을 하는 과정을 OAuth Dance라고 한다.


## 기존의 방식 (비밀번호 인증 방식)의 문제점
![image](https://user-images.githubusercontent.com/66295630/137322572-454f2db3-e7fa-4a8e-8fda-d59b30663fed.png)

  - B의 서비스를 제공하는 A를 이용할 때, B에 인증하기 위해 사용자가 A에게 B의 아이디와 비밀번호를 제공해야한다. 
      - 개인정보를 여러 곳에 입력하면 피싱에 둔감해지고 무엇보다 그 서비스나 어플리케이션이 안전하다는 보장이 없다.
      - ID와 PW를 모두 알고 있는 어플리케이션은 모든 권한을 가진다.
      - PW를 변경한다면 어플리케이션이 동작하지 못하게 된다.
      - 권한을 폐기할 수 있는 유일한 방법이 PW를 변경하는 것 뿐이다.
      


## OAuth 원리
아이디와 패스워드를 이용해서 로그인을 통해 인증을 하는 것은 User와 Service Provider가 직접 한다. 그리고 인증에 성공하면 (access token)토큰을 발급받아서 
이를 인증수단으로 사용하여 Consumer를 통해 서비스를 사용한다.

![image](https://user-images.githubusercontent.com/66295630/137322606-5a37a88c-8ecc-446f-a399-16d63c28a600.png)


1. A가 안내 데스크에서 업무적인 목적으로 B를 만나러 왔다고 말한다. 
-> Request Token의 요청과 발급
2. 안내 데스크에서 B에게 A가 방문했다고 알려준다.
-> 사용자 인증 페이지 호출
3. B가 안내 데스크로 와서 A의 신원을 확인해준다.
-> 사용자 로그인 완료
4. A는 업무 목적과 인적 사항을 안내 데스크에 기록한다.
-> 사용자의 권한 요청 및 수락
5. 안내 데스크에서 A에게 방문증을 발급해준다.
-> Access Token 발급
6. B와 A는 정해진 장소로 가서 업무를 진행한다.
-> Access Token을 이용해 서비스 정보를 요청.

Access Token이 방문증. 이 방문증으로 사전에 허락된 공간에 출입할 수 있다.
마찬가지로 Access Token을 가지고 있는 Consumer는 사전에 호출이 허락된 Service Provider의 오픈 API를 호출할 수 있는 것이다.

'Authorization'(허가) 또한 포함하고 있는 것이다. 그렇기 때문에 OAuth 인증을 진행할 때 해당 서비스 제공자는 
'제 3자가 어떤 정보나 서비스에 사용자의 권한으로 접근하려 하는데 허용하겠느냐'라는 안내 메시지를 보여 주는 것이다.


## 용어

- User(사용자)
  - 서비스를 사용하고자 하는 클라이언트
- Consumer(소비자)
  - B 서비스를 제공하는 웹 혹은 어플리케이션
- Service Provider(서비스 제공자)
  - API나 서비스를 제공
- Request Token(요청 토큰)
  - Consumer가 Service Provider에게 접근 권한을 인증받기 위해 사용하는 값.
- Access Token(접근 토큰)
  - 인증이 완료된 후에 Consumer가 Service Provider의 자원에 접근하기 위한 키를 포함한 값.
  - 즉, 인증 후에 사용자가 서비스 제공자가 아닌 소비자를 통해 자원에 접근하기 위한 키.



## OAuth 1.0과 2.0의 차이점
- 우선 사용하는 용어가 다르다.
- 2.0 에서는 권한 서버와 자원 서버가 따로 분리되어 있다.
- 1.0 에서는 웹은 괜찮으나 어플리케이션에서 적용하기에는 부적합하다. 2.0 부터는 웹 및 앱에서 자유롭게 사용함.
+ 내용 추가해야함.

![image](https://user-images.githubusercontent.com/66295630/137323370-0b6f9940-b647-477a-b7b9-fe44b48c9a58.png)

